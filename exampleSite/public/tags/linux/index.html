<!doctype html><html lang=en-us dir=ltr><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width"><link rel=icon type=image/ico href=http://localhost:1313/favicon//favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon//favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon//favicon-32x32.png><link rel=icon type=image/png sizes=192x192 href=http://localhost:1313/favicon//android-chrome-192x192.png><link rel=apple-touch-icon sizes=180x180 href=http://localhost:1313/favicon//apple-touch-icon.png><link rel=alternate type=application/rss+xml href=http://localhost:1313/tags/linux/index.xml title="My website"><meta name=description content><title>Linux | My website
</title><link rel=canonical href=http://localhost:1313/tags/linux/><meta property="og:url" content="http://localhost:1313/tags/linux/"><meta property="og:site_name" content="My website"><meta property="og:title" content="Linux"><meta property="og:description" content="Here is my website"><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><link rel=stylesheet href=/assets/combined.min.07ce338b4bb43d097400d7890f492d5be8fce1156f207c6d7cf6b096c5338732.css media=all></head><body class=auto><div class=content><header><div class=header><h1 class=header-title><a href=http://localhost:1313/ style=display:flex;align-items:center><img src=/favicon/apple-touch-icon.png alt=Icon height=40>
<span>Home Title</span></a></h1><div class=flex><p class=small><a href=http://localhost:1313/>/home</a></p><p class=small><a href=http://localhost:1313/section1/>/Section1</a></p><p class=small><a href=http://localhost:1313/section2/>/Section2</a></p><p class=small><a href=http://localhost:1313/about>/about</a></p></div></header><main class=main><div class=list-container><div class=breadcrumbs><a href=/>Home</a>
<span class=breadcrumbs-separator>> </span><a href=/tags/>Tags</a>
<span class=breadcrumbs-separator>> </span><a class=breadcrumbs-current href=/tags/linux/>Linux</a></div><h2>Linux</h2><span style=display:block;color:var(--content-secondary);margin-bottom:2em></span><div class=post-line><p class=line-date>Nov 29, 2016</p><div><p class=line-title><a href=/section1/2016-11-29-iptables-usage/>netfilter/iptables 笔记</a></p><p class=line-summary><h2 class=heading id=netfilter-与-iptables>netfilter 与 iptables
<a href=#netfilter-%e4%b8%8e-iptables>#</a></h2><p><code>netfilter</code>是linux默认的防火墙，在2.4之后的版本正式进入内核。<code>netfilter</code> 使用四个表(Table)来存放控制信息包过滤处理的规则集。每张表由链(Chain)组成，每条链又包含了多条规则(rule)。</p><p><code>iptables</code>是用来编辑操作这些表的一个工具。<code>iptables</code>包中也包含了针对IPv6的工具<code>ip6tables</code>。</p><p>四个表及其包含的链：</p><ul><li>filter<ul><li>INPUT</li><li>FORWARD</li><li>OUTPUT</li></ul></li><li>nat<ul><li>PREROUTING</li><li>POSTROUTING</li><li>OUTPUT</li></ul></li><li>mangle<ul><li>PREROUTING</li><li>INPUT</li><li>FORWARD</li><li>OUTPUT</li><li>POSTROUTING</li></ul></li><li>raw<ul><li>PREROUTING</li><li>OUTPUT</li></ul></li></ul><p><figure><div><img loading=lazy alt=img src=/img/2016-11-29-iptables-usage_1.png></div></figure></p><h3 class=heading id=filter机制>filter机制
<a href=#filter%e6%9c%ba%e5%88%b6>#</a></h3><p><code>filter</code>是<code>netfilter</code>中最重要的机制，其任务是执行数据包的过滤操作。具有三种内建链：</p><ul><li>INPUT - 来自外部的数据包（访问本机）</li><li>OUTPUT - 发往外部的数据包（本机访问外部）</li><li>FORWORD - “路过”本机的数据包，转发到其他设备</li></ul><p>链中规则的匹配方式遵循<code>first match</code>。<code>filter</code>会根据数据包特征从相应链中的第一条规则开始逐一进行匹配。只要遇到满足特征的规则后便不再继续。
每条链在最底端都定义了默认规则。默认规则只会有一种状态：<code>ACCEPT</code>或者<code>DROP</code>。默认为<code>ACCEPT</code>。</p><h2 class=heading id=iptables命令参数>iptables命令参数
<a href=#iptables%e5%91%bd%e4%bb%a4%e5%8f%82%e6%95%b0>#</a></h2><p>格式：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span>iptables <span style=color:#ff6ac1>-</span><span style=color:#ff5c57>操作方式</span> [<span style=color:#ff5c57>链名</span>] [<span style=color:#ff5c57>条件匹配</span>] [<span style=color:#ff5c57>选项</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>iptables <span style=color:#ff6ac1>-</span>[ACD] chain rule<span style=color:#ff6ac1>-</span>specification [options]
</span></span><span style=display:flex><span>iptables <span style=color:#ff6ac1>-</span>I chain [rulenum] rule<span style=color:#ff6ac1>-</span>specification [options]
</span></span><span style=display:flex><span>iptables <span style=color:#ff6ac1>-</span>R chain rulenum rule<span style=color:#ff6ac1>-</span>specification [options]
</span></span><span style=display:flex><span>iptables <span style=color:#ff6ac1>-</span>D chain rulenum [options]
</span></span><span style=display:flex><span>iptables <span style=color:#ff6ac1>-</span>[LS] [chain [rulenum]] [options]
</span></span><span style=display:flex><span>iptables <span style=color:#ff6ac1>-</span>[FZ] [chain] [options]
</span></span><span style=display:flex><span>iptables <span style=color:#ff6ac1>-</span>[NX] chain
</span></span><span style=display:flex><span>iptables <span style=color:#ff6ac1>-</span>E old<span style=color:#ff6ac1>-</span>chain<span style=color:#ff6ac1>-</span>name new<span style=color:#ff6ac1>-</span>chain<span style=color:#ff6ac1>-</span>name
</span></span><span style=display:flex><span>iptables <span style=color:#ff6ac1>-</span>P chain target [options]
</span></span><span style=display:flex><span>iptables <span style=color:#ff6ac1>-</span>h (<span style=color:#ff5c57>print</span> this help information)
</span></span></code></pre></div><p>常用操作方式：</p></p></div></div></div></main></div><footer><div class=footer><p>© 2024 <a href=https://github.com/loyistro/Beige>loyistro/beige</a> theme</p></div></footer></body><script>function isAuto(){return document.body.classList.contains("auto")}function setTheme(){if(!isAuto())return;document.body.classList.remove("auto");let e="light";window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(e="dark"),document.body.classList.add(e)}function invertBody(){document.body.classList.toggle("dark"),document.body.classList.toggle("light")}isAuto()&&window.matchMedia("(prefers-color-scheme: dark)").addListener(invertBody),setTheme()</script></html>