<!doctype html><html lang=en-us dir=ltr><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width"><link rel=icon type=image/ico href=http://localhost:1313/favicon//favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon//favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon//favicon-32x32.png><link rel=icon type=image/png sizes=192x192 href=http://localhost:1313/favicon//android-chrome-192x192.png><link rel=apple-touch-icon sizes=180x180 href=http://localhost:1313/favicon//apple-touch-icon.png><meta name=description content><title>composer中的autoload | My website
</title><link rel=canonical href=http://localhost:1313/section1/2016-11-05-php-composer-autoload/><meta property="og:url" content="http://localhost:1313/section1/2016-11-05-php-composer-autoload/"><meta property="og:site_name" content="My website"><meta property="og:title" content="composer中的autoload"><meta property="og:description" content="composer中的autoload"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="section1"><meta property="article:published_time" content="2016-11-05T02:42:06+00:00"><meta property="article:modified_time" content="2016-11-05T02:42:06+00:00"><meta property="article:tag" content="Php"><meta property="article:tag" content="Tech"><link rel=stylesheet href=/assets/combined.min.05551369284410b38ef37e788e9db6f082acb97c844c6f7e8a789540f0cfd84d.css media=all></head><body class=dark><div class=content><header><div class=header><h1 class=header-title><a href=http://localhost:1313/ style=display:flex;align-items:center><img src=/favicon/apple-touch-icon.png alt=Icon height=40>
<span>Home Title</span></a></h1><div class="menu flex"><p class=menu-item><a href=http://localhost:1313/>/home</a></p><p class=menu-item><a href=http://localhost:1313/section1/>/Section1</a></p><p class=menu-item><a href=http://localhost:1313/section2/>/Section2</a></p><p class=menu-item><a href=http://localhost:1313/about>/about</a></p></div><hr></header><main class=main><div class=breadcrumbs><a href=/>Home</a>
<span class=breadcrumbs-separator>> </span><a href=/section1/>Section 1</a>
<span class=breadcrumbs-separator>> </span><a class=breadcrumbs-current href=/section1/2016-11-05-php-composer-autoload/>composer中的autoload</a></div><div class=autonumber><div class=single-intro-container><h1 class=single-title>composer中的autoload</h1><p class=single-summary>composer中的autoload</p><p class=single-readtime><time datetime=2016-11-05T02:42:06+00:00>Nov 5, 2016</time>
&nbsp; · &nbsp;
1 min read
&nbsp; · &nbsp;
<span class=single-tags><a href=/tags/php/>#Php
</a><a href=/tags/tech/>#Tech</a></span></p></div><aside class=toc><p><strong>Table of contents</strong></p><nav id=TableOfContents><ul><li><ul><li><a href=#psr-4>PSR-4</a></li><li><a href=#classmap>classmap</a></li></ul></li></ul></nav></aside><div class=single-content><p>composer的autoload可以轻松的实现php的自动加载。在<code>composer.json</code>中添加<code>autoload</code>字段即可。当前支持 <code>PSR-0</code> <code>PSR-4</code> <code>classmap</code>解析和<code>files</code>包含。官方推荐PSR-4标准（添加类时不需要重新生成加载器）。</p><h3 class=heading id=psr-4>PSR-4
<a href=#psr-4>#</a></h3><p>Under the <code>psr-4</code> key you define a mapping from namespaces to paths, relative to the package root. When autoloading a class like <code>Foo\\Bar\\Baz</code> a namespace prefix <code>Foo\\</code> pointing to a directory <code>src/</code> means that the autoloader will look for a file named <code>src/Bar/Baz.php</code> and include it if present. Note that as opposed to the older PSR-0 style, the prefix (<code>Foo\\</code>) is not present in the file path.</p><p>Namespace prefixes must end in <code>\\</code> to avoid conflicts between similar prefixes. For example Foo would match classes in the FooBar namespace so the trailing backslashes solve the problem: <code>Foo\\</code> and <code>FooBar\\</code> are distinct.</p><p>The PSR-4 references are all combined, during install/update, into a single key => value array which may be found in the generated file <code>vendor/composer/autoload_psr4.php</code>.</p><p>实例：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#5af78e>&#34;autoload&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;psr-4&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#5af78e>&#34;Monolog</span><span style=color:#5af78e>\\</span><span style=color:#5af78e>&#34;</span>: <span style=color:#5af78e>&#34;src/&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#5af78e>&#34;Vendor</span><span style=color:#5af78e>\\</span><span style=color:#5af78e>Namespace</span><span style=color:#5af78e>\\</span><span style=color:#5af78e>&#34;</span>: <span style=color:#5af78e>&#34;&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>如果需要在多个目录下搜索相同前缀，可以以数组的形式指定。</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#5af78e>&#34;autoload&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;psr-4&#34;</span>: { <span style=color:#5af78e>&#34;Monolog</span><span style=color:#5af78e>\\</span><span style=color:#5af78e>&#34;</span>: [<span style=color:#5af78e>&#34;src/&#34;</span>, <span style=color:#5af78e>&#34;lib/&#34;</span>] }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>也可为所有命名空间指定默认文件夹：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#5af78e>&#34;autoload&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;psr-4&#34;</span>: { <span style=color:#5af78e>&#34;&#34;</span>: <span style=color:#5af78e>&#34;src/&#34;</span> }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 class=heading id=classmap>classmap
<a href=#classmap>#</a></h3><p><code>classmap</code> 引用的所有组合，都会在 <code>install/update</code> 过程中生成，并存储到 <code>vendor/composer/autoload_classmap.php</code> 文件中。这个 <code>map</code> 是经过扫描指定目录（同样支持直接精确到文件）中所有的 <code>.php</code> 和 <code>.inc</code> 文件里内置的类而得到的。</p><p>你可以用 <code>classmap</code> 生成支持支持自定义加载的不遵循 <code>PSR-0/4</code> 规范的类库。要配置它指向需要的目录，以便能够准确搜索到类文件。</p><p>实例：</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript3 data-lang=gdscript3><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#5af78e>&#34;autoload&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;classmap&#34;</span>: [<span style=color:#5af78e>&#34;src/&#34;</span>, <span style=color:#5af78e>&#34;lib/&#34;</span>, <span style=color:#5af78e>&#34;Something.php&#34;</span>]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>相关链接</strong></p><p><a href=http://www.php-fig.org/psr/psr-4/examples/>Example Implementations of PSR-4</a></p><p><a href=https://getcomposer.org/doc/04-schema.md#autoload>The composer.json Schema</a></p><p><a href=http://drops.leavesongs.com/php/composer-autoload-class-and-function-written-myself.html>如何使用composer的autoload来自动加载自己编写的函数库与类库</a></p><p><a href=http://gywbd.github.io/posts/2014/12/composer-autoload.html>使用composer中的autoload</a></p></div><div class=single-pagination><hr><div class=flex><div class=single-pagination-prev><div class=single-pagination-container-prev><div class=single-pagination-text>←</div><div class=single-pagination-text><a href=/section1/2016-10-22-z/>幸せ</a></div></div></div><div class=single-pagination-next><div class=single-pagination-container-next><div class=single-pagination-text><a href=/section1/2016-11-29-iptables-usage/>netfilter/iptables 笔记</a></div><div class=single-pagination-text>→</div></div></div></div><hr></div><div class=back-to-top><a href=#top>↑ Back to top</a></div></div></main></div><footer><div class=footer><p>© 2024 <a href=https://github.com/loyistro/Beige>loyistro/beige</a> theme</p></div></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script></body><script>function isAuto(){return document.body.classList.contains("auto")}function setTheme(){if(!isAuto())return;document.body.classList.remove("auto");let e="light";window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(e="dark"),document.body.classList.add(e)}function invertBody(){document.body.classList.toggle("dark"),document.body.classList.toggle("light")}isAuto()&&window.matchMedia("(prefers-color-scheme: dark)").addListener(invertBody),setTheme()</script></html>